import{_ as d,c as l,a as s,F as h,f as u,o as a,n as g,t as m}from"./index-C23T03Zw.js";const p={name:"WordSelectionPage",data(){return{targetWords:[],wordOptions:[],selectedWords:[],isLoading:!0}},async created(){await this.fetchTargetWords(),this.generateWordOptions()},methods:{async fetchTargetWords(){try{const e=JSON.parse(localStorage.getItem("currentUser"));if(console.log("当前用户信息:",e),!e||!e.hospitalNumber||!e.name)throw console.error("用户信息不完整:",e),new Error("用户信息不完整");console.log("请求参数:",{hospitalNumber:e.hospitalNumber,name:e.name});const t=await fetch(`http://172.22.104.102:8080/api/select?hospitalNumber=${e.hospitalNumber}&name=${encodeURIComponent(e.name)}`);if(!t.ok)throw new Error("获取单词失败");const o=await t.json();this.targetWords=o.words,console.log("从API获取的正确单词:",this.targetWords)}catch(e){console.error("获取目标单词错误:",e),alert("获取单词失败: "+e.message)}finally{this.isLoading=!1}},generateWordOptions(){const t=["苹果","香蕉","橙子","梨","葡萄","西瓜","芒果","草莓","菠萝"].filter(o=>!this.targetWords.includes(o)).sort(()=>.5-Math.random()).slice(0,6);this.wordOptions=[...this.targetWords,...t].sort(()=>Math.random()-.5)},toggleWord(e){this.selectedWords.includes(e)?this.selectedWords=this.selectedWords.filter(t=>t!==e):this.selectedWords.length<3&&this.selectedWords.push(e)},submitSelection(){const e=this.selectedWords.filter(o=>this.targetWords.includes(o)).length,t=e===3?5:e===2?3:e===1?1:0;localStorage.setItem("selectScore",t),this.$router.push("/key")}}},W={class:"word-selection-page"},f={class:"word-grid"},b=["onClick"],_={class:"controls"};function w(e,t,o,S,i,n){return a(),l("div",W,[t[1]||(t[1]=s("div",{class:"header"},[s("h1",{class:"title"},"单词选择测试")],-1)),t[2]||(t[2]=s("div",{class:"instruction"},[s("p",null,"请选择您之前看到的3个单词")],-1)),s("div",f,[(a(!0),l(h,null,u(i.wordOptions,(r,c)=>(a(),l("button",{key:c,class:g(["word-button",{selected:i.selectedWords.includes(r)}]),onClick:k=>n.toggleWord(r)},m(r),11,b))),128))]),s("div",_,[s("button",{class:"submit-button",onClick:t[0]||(t[0]=(...r)=>n.submitSelection&&n.submitSelection(...r))},"提交")])])}const y=d(p,[["render",w],["__scopeId","data-v-633b53bf"]]);export{y as default};
